<header class="bg-gray-800 text-white sticky top-0 z-50 shadow-lg">
  <nav class="container mx-auto px-4 py-4">
    <div class="flex items-center justify-between flex-wrap gap-4">
      <!-- Logo -->
      <%= link_to root_path, class: "text-2xl font-bold flex items-center gap-2 hover:text-blue-400 transition" do %>
        <span>Iron & Motion</span>
      <% end %>

      <!-- Search Bar -->
      <div class="hidden md:block flex-1 max-w-md mx-8">
        <%= form_with url: search_products_path, method: :get, class: "flex" do |f| %>
          <%= f.text_field :query,
              placeholder: "Search products...",
              class: "flex-1 px-4 py-2 rounded-l-lg text-gray-900 focus:outline-none focus:ring-2 focus:ring-blue-500",
              value: params[:query] %>
          <%= f.submit "Search", class: "px-4 py-2 bg-blue-600 rounded-r-lg hover:bg-blue-700 transition cursor-pointer" %>
        <% end %>
      </div>

      <!-- Navigation Links -->
      <div class="flex items-center gap-6">
        <%= link_to "Products", products_path, class: "hover:text-blue-400 transition" %>
        <%= link_to "About", about_path, class: "hover:text-blue-400 transition" %>
        <%= link_to "Contact", contact_path, class: "hover:text-blue-400 transition" %>

        <% if user_signed_in? %>
          <%= link_to "My Orders", orders_path, class: "hover:text-blue-400 transition" %>
          <%= link_to "Logout", destroy_user_session_path, data: { turbo_method: :delete }, class: "hover:text-blue-400 transition" %>
        <% else %>
          <%= link_to "Login", new_user_session_path, class: "hover:text-blue-400 transition" %>
          <%= link_to "Sign Up", new_user_registration_path, class: "px-4 py-2 bg-blue-600 rounded hover:bg-blue-700 transition" %>
        <% end %>

        <!-- Cart Icon -->
        <%= link_to shopping_cart_path, class: "relative hover:text-blue-400 transition" do %>
          <svg class="w-6 h-6" fill="none" stroke="currentColor" viewBox="0 0 24 24">
            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M3 3h2l.4 2M7 13h10l4-8H5.4M7 13L5.4 5M7 13l-2.293 2.293c-.63.63-.184 1.707.707 1.707H17m0 0a2 2 0 100 4 2 2 0 000-4zm-8 2a2 2 0 11-4 0 2 2 0 014 0z"></path>
          </svg>
          <% if user_signed_in? && current_user.shopping_cart&.shopping_cart_items&.any? %>
            <span class="absolute -top-2 -right-2 bg-red-500 text-white text-xs rounded-full w-5 h-5 flex items-center justify-center">
              <%= current_user.shopping_cart.item_count %>
            </span>
          <% end %>
        <% end %>
      </div>
    </div>

    <!-- Mobile Search Bar -->
    <div class="md:hidden mt-4">
      <%= form_with url: search_products_path, method: :get, class: "flex" do |f| %>
        <%= f.text_field :query,
            placeholder: "Search products...",
            class: "flex-1 px-4 py-2 rounded-l-lg text-gray-900 focus:outline-none focus:ring-2 focus:ring-blue-500",
            value: params[:query] %>
        <%= f.submit "Search", class: "px-4 py-2 bg-blue-600 rounded-r-lg hover:bg-blue-700 transition cursor-pointer" %>
      <% end %>
    </div>
  </nav>
</header>
